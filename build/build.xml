<?xml version="1.0" encoding="UTF-8"?>
<!-- ====================================================================== 
     15. jun 2012 21:16:20                                                        

     AWD Tools  
     description
                   
     Pierre Lepers                                                             
     ====================================================================== -->
<project name="AWD Tools" default="main" basedir="../">

	<description>
            build digitas awd tools
    </description>

	<property name="FMK_HOME" location="${basedir}" />
	<loadproperties srcfile="${basedir}/build/build.properties" />



	<!-- ================================= 
          target: main              
         ================================= -->
	<target name="main" depends="init" description="description">
		<antcall target="compile awd_little_endian">
		</antcall>
		<antcall target="create awd_little_endian excutables">
		</antcall>

	</target>

	<!-- ================================= 
          target: compile awd_little_endian              
         ================================= -->
	<target name="compile awd_little_endian"
	        depends="init"
	        description="description">

		<java jar="${redtamarin.asc}" fork="true">
			<arg line="-help" />
		</java>
		<java jar="${redtamarin.asc}" fork="true">
			<arg line="-import ${redtamarin.libs.builtin}" />
			<arg line="-import ${redtamarin.libs.toplevel}" />
			<arg line="-d" />
			<arg line="-strict" />
			<arg line="${basedir}/src/awd/awd_little_endian.as" />
		</java>

		<move file="${basedir}/src/awd/awd_little_endian.abc"
		      tofile="${basedir}/libs/awd_little_endian.abc" />

	</target>

	<!-- ================================= 
          target: create awd_little_endian excutables
         ================================= -->
	<target name="create awd_little_endian excutables"
	        depends="init"
	        description="description">

		<delete>
			<fileset dir="${basedir}/bin/">
				<include name="**/awd_little_endian*" />
			</fileset>
		</delete>


		<exec executable="${redtamarin.createprojector}" dir="${basedir}">
			<arg line="-exe ${redtamarin.win.avmplus_d}" />
			<arg line="-o ${basedir}/bin/win/awd_little_endian.exe" />
			<arg line="${basedir}/libs/awd_little_endian.abc" />
		</exec>
		<exec executable="${redtamarin.createprojector}" dir="${basedir}">
			<arg line="-exe ${redtamarin.osx.avmplus}" />
			<arg line="-o ${basedir}/bin/osx/awd_little_endian" />
			<arg line="${basedir}/libs/awd_little_endian.abc" />
		</exec>
		<exec executable="${redtamarin.createprojector}" dir="${basedir}">
			<arg line="-exe ${redtamarin.nix.avmplus}" />
			<arg line="-o ${basedir}/bin/nix/awd_little_endian" />
			<arg line="${basedir}/libs/awd_little_endian.abc" />
		</exec>



	</target>


	<!-- ================================= 
	          target: compile merge_geoms              
	         ================================= -->
	<target name="compile merge_geoms" depends="init" description="description">

		<java jar="${redtamarin.asc}" fork="true">
			<arg line="-import ${redtamarin.libs.builtin}" />
			<arg line="-import ${redtamarin.libs.toplevel}" />
			<arg line="-d" />
			<arg line="-strict" />
			<arg line="${basedir}/src/awd/cmd/merge_geoms.as" />
		</java>

		<move file="${basedir}/src/awd/cmd/merge_geoms.abc"
		      tofile="${basedir}/libs/merge_geoms.abc" />

		<delete>
			<fileset dir="${basedir}/bin/">
				<include name="**/merge_geoms*" />
			</fileset>
		</delete>


		<exec executable="${redtamarin.createprojector}" dir="${basedir}">
			<arg line="-exe ${redtamarin.win.avmplus_d}" />
			<arg line="-o ${basedir}/bin/win/merge_geoms.exe" />
			<arg line="${basedir}/libs/merge_geoms.abc" />
		</exec>
		<exec executable="${redtamarin.createprojector}" dir="${basedir}">
			<arg line="-exe ${redtamarin.osx.avmplus}" />
			<arg line="-o ${basedir}/bin/osx/merge_geoms" />
			<arg line="${basedir}/libs/merge_geoms.abc" />
		</exec>
		<exec executable="${redtamarin.createprojector}" dir="${basedir}">
			<arg line="-exe ${redtamarin.nix.avmplus}" />
			<arg line="-o ${basedir}/bin/nix/merge_geoms" />
			<arg line="${basedir}/libs/merge_geoms.abc" />
		</exec>
		
		
		<ant antfile="${basedir}/build/tests.xml" target="merge_geoms test"></ant>
		
	</target>






	<!-- - - - - - - - - - - - - - - - - - 
          target: init                      
         - - - - - - - - - - - - - - - - - -->
	<target name="init">


	</target>

</project>
